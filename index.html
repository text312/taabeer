<!DOCTYPE html>
<html lang="ar" dir="rtl">
<!--
  Couples Feelings Diary / مذكرات المشاعر للزوجين
  Romantic dual-language platform for couples to share emotions
  Features: heart animations, romantic design, elegant UI, and love-themed interactions
-->

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>مذكرات المشاعر للزوجين</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #ff4d78;
      --primary-light: #ff85a2;
      --primary-dark: #d93d65;
      --secondary: #7f5af0;
      --accent: #25d0ab;
      --text: #2e2e3a;
      --text-light: #5a5a6e;
      --bg: #fff8fa;
      --card-bg: rgba(255, 255, 255, 0.92);
      --card-shadow: 0 10px 30px rgba(255, 112, 150, 0.15);
      --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
      --border-radius: 24px;
    }
    .dark {
      --primary: #ff85a2;
      --primary-light: #ffb3c6;
      --primary-dark: #ff7096;
      --secondary: #9370ff;
      --accent: #2ce0b9;
      --text: #f0f0f5;
      --text-light: #c2c2d6;
      --bg: #1a1a24;
      --card-bg: rgba(30, 30, 40, 0.95);
      --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
    }
    
    /* Base Styles */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Tajawal', 'Poppins', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow-x: hidden;
      transition: var(--transition);
      line-height: 1.6;
      position: relative;
    }
    body::before {
      content: '';
      position: fixed;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle at 70% 30%, rgba(255, 112, 150, 0.05) 0%, transparent 50%),
                  radial-gradient(circle at 30% 70%, rgba(127, 90, 240, 0.05) 0%, transparent 50%);
      animation: gradientRotate 30s linear infinite;
      z-index: -2;
    }
    @keyframes gradientRotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Floating Hearts Animation */
    .floating-hearts {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      overflow: hidden;
    }
    .floating-heart {
      position: absolute;
      opacity: 0;
      animation: float 15s linear infinite;
      will-change: transform;
      font-size: 24px;
      color: var(--primary);
      text-shadow: 0 2px 10px rgba(255, 112, 150, 0.3);
    }
    @keyframes float {
      0% { transform: translateY(100vh) rotate(0deg) scale(0.5); opacity: 0; }
      10% { opacity: 0.8; }
      90% { opacity: 0.8; }
      100% { transform: translateY(-20vh) rotate(360deg) scale(1); opacity: 0; }
    }
    
    /* Couple Animation */
    .couple-animation {
      position: fixed;
      bottom: -100px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 200px;
      pointer-events: none;
      z-index: -1;
      opacity: 0.7;
      transition: all 0.5s ease;
    }
    .couple-animation.active {
      bottom: 20px;
      opacity: 1;
    }
    .couple-animation svg {
      width: 100%;
      height: 100%;
      filter: drop-shadow(0 5px 15px rgba(255, 112, 150, 0.4));
    }
    
    /* Main Container */
    .container {
      position: relative;
      background: var(--card-bg);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      padding: 2.5rem 2.5rem;
      width: 95%;
      max-width: 600px;
      text-align: center;
      transform-style: preserve-3d;
      perspective: 1000px;
      animation: fadeInUp 1s cubic-bezier(0.23, 1, 0.32, 1) both;
      border: 1px solid rgba(255, 255, 255, 0.15);
      overflow: hidden;
      margin: 2rem 0;
    }
    .container::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: rotate(45deg);
      pointer-events: none;
      animation: shine 6s infinite;
    }
    @keyframes shine {
      0% { transform: translateX(-100%) rotate(45deg); }
      100% { transform: translateX(100%) rotate(45deg); }
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Header */
    h1 {
      font-size: 2.4rem;
      color: var(--primary);
      margin-bottom: 1.8rem;
      font-weight: 700;
      position: relative;
      display: inline-block;
      text-shadow: 0 2px 5px rgba(255, 112, 150, 0.2);
    }
    h1::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      border-radius: 3px;
      box-shadow: 0 2px 5px rgba(255, 112, 150, 0.3);
    }
    
    /* Toggle Buttons */
    .toggle-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.8rem;
      gap: 1rem;
    }
    .toggle-btn {
      background: rgba(127, 90, 240, 0.1);
      border: none;
      border-radius: 50px;
      padding: 0.6rem 1.2rem;
      font-size: 0.95rem;
      font-weight: 500;
      color: var(--secondary);
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.6rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    .toggle-btn:hover {
      background: rgba(127, 90, 240, 0.2);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .toggle-btn:active {
      transform: translateY(0);
    }
    .toggle-btn i {
      font-size: 1.1rem;
    }
    
    /* Textarea */
    textarea {
      width: 100%;
      padding: 1.5rem;
      border-radius: 18px;
      border: 2px solid rgba(255, 112, 150, 0.3);
      font-size: 1.1rem;
      resize: vertical;
      min-height: 180px;
      background: rgba(255, 255, 255, 0.85);
      color: var(--text);
      transition: var(--transition);
      font-family: inherit;
      box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
    }
    .dark textarea {
      background: rgba(30, 30, 40, 0.8);
      border-color: rgba(255, 112, 150, 0.2);
    }
    textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(255, 112, 150, 0.2);
      background: rgba(255, 255, 255, 0.95);
    }
    .dark textarea:focus {
      background: rgba(40, 40, 50, 0.95);
    }
    
    /* Mood Selector */
    .mood-selector {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 16px;
      padding: 12px 24px;
      margin: 16px 0;
      border: 2px solid var(--border-color);
      transition: var(--transition);
      background: rgba(255, 255, 255, 0.6);
      border-radius: 18px;
      box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.05);
    }
    .mood-selector.error-pulse {
      box-shadow: 0 0 0 4px #ff4d4d55;
      animation: errorPulse 0.6s;
    }
    @keyframes errorPulse {
      0% { box-shadow: 0 0 0 0 #ff4d4d55; }
      60% { box-shadow: 0 0 0 8px #ff4d4d33; }
      100% { box-shadow: 0 0 0 0 #ff4d4d00; }
    }
.dark .mood-selector {
      background: rgba(30, 30, 40, 0.6);
    }
    .mood-option {
      background: none;
      border: none;
      cursor: pointer;
      transition: var(--transition);
      padding: 0.8rem;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      min-width: 70px;
    }
    .mood-option:hover {
      transform: translateY(-3px);
      background: rgba(255, 112, 150, 0.15);
    }
    .mood-option.active {
      background: rgba(255, 112, 150, 0.2);
      transform: translateY(-3px);
    }
    .mood-icon {
      font-size: 1.8rem;
      color: var(--primary);
    }
    .mood-label {
      font-size: 0.8rem;
      color: var(--text-light);
    }
    
    /* Submit Button */
    .submit-btn {
      background: linear-gradient(90deg, #ff4d78, #7f5af0);
      color: white;
      border: none;
      border-radius: 50px;
      padding: 1.1rem 2.8rem;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 6px 20px rgba(255, 112, 150, 0.3);
      position: relative;
      overflow: hidden;
      margin-top: 0.8rem;
      width: 100%;
      max-width: 240px;
      display: block;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
    }
    .submit-btn > * {
      vertical-align: middle;
      display: inline-block;
    }
    .submit-btn .fas {
      margin-left: 0.6rem;
      margin-right: 0.2rem;
    }
    .submit-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(255, 112, 150, 0.4);
    }
    .submit-btn:active {
      transform: translateY(0);
    }
    .submit-btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(45deg);
      pointer-events: none;
      animation: shine 4s infinite;
    }
    .submit-btn[disabled] {
      background: var(--text-light);
      box-shadow: none;
      cursor: not-allowed;
      opacity: 0.7;
    }
    .submit-btn i {
      font-size: 1.2rem;
    }
    
    /* Loading Animation */
    .loading-dots {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.3rem;
    }
    .loading-dots span {
      display: inline-block;
      width: 8px;
      height: 8px;
      background: currentColor;
      border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out both;
    }
    .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
    .loading-dots span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }
    
    /* Admin Button */
    .admin-btn {
      background: rgba(37, 208, 171, 0.1);
      color: var(--accent);
      border: none;
      border-radius: 50px;
      padding: 0.8rem 1.5rem;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      margin-top: 1.8rem;
      display: inline-flex;
      align-items: center;
      gap: 0.6rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    .admin-btn:hover {
      background: rgba(37, 208, 171, 0.2);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .admin-btn i {
      font-size: 1.1rem;
    }
    
    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .modal-overlay.active {
      opacity: 1;
      pointer-events: all;
    }
    .modal {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
      padding: 2rem;
      width: 90%;
      max-width: 400px;
      transform: translateY(20px);
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .modal-overlay.active .modal {
      transform: translateY(0);
    }
    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-light);
      cursor: pointer;
      transition: var(--transition);
    }
    .modal-close:hover {
      color: var(--primary);
      transform: rotate(90deg);
    }
    .modal-input-wrapper {
      position: relative;
      width: 100%;
      display: flex;
      align-items: center;
    }
    #toggle-password {
      position: absolute;
      left: 0;
      top: 0;
      width: 2.5rem;
      height: 100%;
      min-height: 0;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.2rem;
      color: #888;
      outline: none;
      padding: 0;
      z-index: 2;
      transition: color 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-input-wrapper {
      position: relative;
      width: 100%;
      display: block;
    }
    .modal-input {
      width: 100%;
      box-sizing: border-box;
      padding-left: 2.5rem;
      padding-right: 0.75rem;
      /* Default: icon on left for RTL */
    }
    html[dir="ltr"] .modal-input {
      padding-right: 2.5rem;
      padding-left: 0.75rem;
    }
    #toggle-password {
      position: absolute;
      top: 0;
      left: 0;
      width: 2.5rem;
      height: 100%;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.2rem;
      color: #888;
      outline: none;
      padding: 0;
      z-index: 2;
      transition: color 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    html[dir="ltr"] #toggle-password {
      left: auto;
      right: 0;
    }

    #toggle-password:active {
      color: var(--primary);
    }
    .modal-title {
      color: var(--primary);
      margin-bottom: 1.5rem;
      font-size: 1.5rem;
      text-align: center;
    }
    .modal-input {
      width: 100%;
      padding: 1rem 1rem 1rem 2.5rem;
      border-radius: 12px;
      border: 2px solid rgba(255, 112, 150, 0.3);
      background: rgba(255, 255, 255, 0.7);
      color: var(--text);
      margin-bottom: 1.5rem;
      transition: var(--transition);
      font-family: inherit;
    }
    .dark .modal-input {
      background: rgba(30, 30, 40, 0.7);
    }
    .modal-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(255, 112, 150, 0.2);
    }
    .modal-error {
      color: #ff4d4d;
      margin-top: 0.5rem;
      min-height: 1.2em;
      text-align: center;
    }
    
    /* Admin Panel */
    .admin-panel {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 200;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem 1rem;
      overflow-y: auto;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .admin-panel.active {
      opacity: 1;
      pointer-events: all;
    }
    .admin-container {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
      padding: 2rem;
      width: 100%;
      max-width: 600px;
      margin: auto;
      position: relative;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .admin-title {
      color: var(--primary);
      font-size: 1.5rem;
    }
    .logout-btn {
      margin-right: 7.5rem;
      background: rgba(255, 112, 150, 0.1);
      color: var(--primary);
      border: none;
      border-radius: 50px;
      padding: 0.5rem 1rem;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .logout-btn:hover {
      background: rgba(255, 112, 150, 0.2);
      transform: translateY(-2px);
    }
    .messages-list {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    .message-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.05);
      animation: fadeIn 0.5s ease both;
      transition: var(--transition);
      position: relative;
    }
    .dark .message-card {
      background: rgba(40, 40, 50, 0.5);
    }
    .message-card.unread {
      border-left: 4px solid var(--primary);
    }
    .message-content {
      font-size: 1.1rem;
      white-space: pre-line;
      word-break: break-word;
      margin-bottom: 1rem;
      line-height: 1.7;
    }
    .message-date {
      font-size: 0.85rem;
      color: var(--text-light);
      margin-bottom: 0.5rem;
    }
    .message-actions {
      display: flex;
      gap: 0.5rem;
      justify-content: flex-end;
      margin-top: 1rem;
    }
    .msg-status-badge {
      display: inline-block;
      font-size: 0.85rem;
      font-weight: 600;
      border-radius: 12px;
      padding: 0.2rem 0.7rem;
      margin-right: 0.6rem;
      margin-left: 0.2rem;
      vertical-align: middle;
    }
    .read-badge {
      background: rgba(37, 208, 171, 0.15);
      color: var(--accent);
      border: 1px solid var(--accent);
    }
    .unread-badge {
      background: rgba(255, 77, 79, 0.13);
      color: #ff4d4f;
      border: 1px solid #ff4d4f;
    }
    .message-btn {
      padding: 0.4rem 1.1rem;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      display: flex;
      align-items: center;
      gap: 0.3rem;
      outline: none;
    }
    .read-btn {
      background: rgba(37, 208, 171, 0.12);
      color: var(--accent);
    }
    .read-btn:hover {
      background: rgba(37, 208, 171, 0.22);
      color: var(--accent);
      transform: translateY(-2px);
    }
    .delete-btn {
      background: rgba(255, 77, 79, 0.10);
      color: #ff4d4f;
    }
    .delete-btn:hover {
      background: rgba(255, 77, 79, 0.18);
      color: #ff4d4f;
      transform: translateY(-2px);
    }
    .message-btn {
      padding: 0.4rem 0.8rem;
      border-radius: 8px;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      border: none;
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }
    .read-btn {
      background: rgba(37, 208, 171, 0.1);
      color: var(--accent);
    }
    .read-btn:hover {
      background: rgba(37, 208, 171, 0.2);
    }
    .delete-btn {
      background: rgba(255, 77, 79, 0.1);
      color: #ff4d4f;
    }
    .delete-btn:hover {
      background: rgba(255, 77, 79, 0.2);
    }
    .dark .message-card {
      background: rgba(40, 40, 50, 0.5);
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .message-content {
      font-size: 1.1rem;
      white-space: pre-line;
      word-break: break-word;
      margin-bottom: 1rem;
      line-height: 1.7;
    }
    .message-date {
      font-size: 0.85rem;
      color: var(--text-light);
      text-align: right;
    }
    .empty-state {
      text-align: center;
      padding: 2rem;
      color: var(--text-light);
      font-size: 1.1rem;
    }
    .loading-state {
      display: flex;
      justify-content: center;
      padding: 2rem;
    }
    
    /* Heart Pulse Animation */
    .heart-pulse {
      position: absolute;
      width: 30px;
      height: 30px;
      color: var(--primary);
      animation: pulse 2s infinite;
      opacity: 0;
      pointer-events: none;
    }
    @keyframes pulse {
      0% { transform: scale(0.5); opacity: 0; }
      50% { opacity: 0.8; }
      100% { transform: scale(1.5); opacity: 0; }
    }
    
    /* Responsive Adjustments */
    @media (max-width: 768px) {
      .container {
        padding: 2rem 1.8rem;
        max-width: 500px;
      }
      h1 {
        font-size: 2rem;
      }
      .mood-selector {
        gap: 0.5rem;
      }
      .mood-option {
        min-width: 60px;
        padding: 0.6rem;
      }
    }
    @media (max-width: 600px) {
      .container {
        padding: 1.8rem 1.5rem;
        border-radius: 20px;
      }
      h1 {
        font-size: 1.8rem;
      }
      textarea {
        font-size: 1rem;
        padding: 1rem;
      }
      .submit-btn {
        padding: 1rem 2rem;
        font-size: 1rem;
      }
      .admin-container {
        padding: 1.5rem;
      }
      .mood-selector {
        flex-wrap: wrap;
        justify-content: center;
      }
    }
    @media (max-width: 400px) {
      .container {
        padding: 1.5rem 1.2rem;
      }
      h1 {
        font-size: 1.6rem;
      }
      .toggle-btn, .admin-btn, .logout-btn {
        font-size: 0.85rem;
        padding: 0.4rem 0.8rem;
      }
    }
    /* Hide all scrollbars but allow scrolling */
    html, body, * {
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
    }
    html::-webkit-scrollbar, body::-webkit-scrollbar, *::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }
  </style>
</head>
<body>
  <!-- Floating Hearts Background -->
  <div class="floating-hearts" id="floating-hearts"></div>
  
  <!-- Couple Animation -->
  <div class="couple-animation" id="couple-animation">
    <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
      <path fill="#FFD3E0" d="M50,150 C60,130 80,120 100,120 C120,120 140,130 150,150 C160,170 150,190 130,190 C110,190 90,170 80,150 C70,130 50,110 30,110 C10,110 0,130 10,150 C20,170 40,170 50,150 Z"/>
    </svg>
  </div>
  
  <!-- Main App Container -->
  <div class="container" id="app">
    <div class="toggle-row">
      <button class="toggle-btn" id="lang-toggle" onclick="toggleLang()">
        <i class="fas fa-language"></i>
        <span id="lang-text">English</span>
      </button>
      <button class="toggle-btn" id="mode-toggle" onclick="toggleMode()">
        <i class="fas fa-moon" id="mode-icon"></i>
        <span id="mode-text">الوضع المظلم</span>
      </button>
    </div>
    
    <h1 id="title">مذكرات المشاعر للزوجين</h1>
    
    <div class="mood-selector" id="mood-selector">
      <button class="mood-option" data-mood="happy">
        <i class="fas fa-laugh-beam mood-icon"></i>
        <span class="mood-label" id="happy-label">سعيدة</span>
      </button>
      <button class="mood-option" data-mood="love">
        <i class="fas fa-heart mood-icon"></i>
        <span class="mood-label" id="love-label">حب</span>
      </button>
      <button class="mood-option" data-mood="sad">
        <i class="fas fa-sad-tear mood-icon"></i>
        <span class="mood-label" id="sad-label">حزينة</span>
      </button>
      <button class="mood-option" data-mood="angry">
        <i class="fas fa-angry mood-icon"></i>
        <span class="mood-label" id="angry-label">غاضبة</span>
      </button>
      <button class="mood-option" data-mood="excited">
        <i class="fas fa-grin-stars mood-icon"></i>
        <span class="mood-label" id="excited-label">متحمسة</span>
      </button>
    </div>
    
    <textarea id="message" rows="6" placeholder="اكتبي ما تشعرين به هنا..." maxlength="800"></textarea>
    
    <button class="submit-btn" id="submit-btn" onclick="sendMessage()">
      <i class="fas fa-paper-plane"></i>
      <span id="submit-text">إرسال</span>
    </button>
    
    <button class="admin-btn" onclick="showLoginModal()">
      <i class="fas fa-lock"></i>
      <span id="admin-text">دخول المشرف</span>
    </button>
  </div>
  
  <!-- Admin Login Modal -->
  <div class="modal-overlay" id="login-modal">
    <div class="modal">
      <button class="modal-close" onclick="hideLoginModal()">✕</button>
      <h2 class="modal-title" id="login-title">دخول المشرف</h2>
      <div class="modal-input-wrapper" style="position:relative;">
        <input type="password" class="modal-input" id="admin-password" placeholder="كلمة المرور">
        <button type="button" id="toggle-password" tabindex="-1" aria-label="Show/Hide Password"><i class="fas fa-eye"></i></button>
      </div>
      <div class="modal-error" id="login-error"></div>
      <button class="submit-btn" id="login-btn" onclick="adminLogin()">
        <i class="fas fa-sign-in-alt"></i>
        <span id="login-text">دخول</span>
      </button>
    </div>
  </div>
  
  <!-- Admin Panel -->
  <div class="admin-panel" id="admin-panel">
    <div class="admin-container">
      <div class="admin-header">
        <button class="modal-close" id="admin-panel-close" style="margin-left:0.5rem;" onclick="hideAdminPanel()">✕</button>
        <h2 class="admin-title" id="msgs-title">الرسائل المستلمة</h2>
        <button class="logout-btn" onclick="logoutAdmin()">
          <i class="fas fa-sign-out-alt"></i>
          <span id="logout-text">خروج</span>
        </button>
      </div>
      
      <div class="messages-list" id="msgs-list"></div>
      
      <div class="loading-state" id="msgs-loading" style="display: none;">
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
      
      <div class="empty-state" id="msgs-empty" style="display: none;">
        <span id="no-msgs-text">لا توجد رسائل بعد</span>
      </div>
      
      <div class="modal-error" id="msgs-error"></div>
    </div>
  </div>

  <script>
    // --- Configuration ---
    let isArabic = localStorage.getItem('isArabic') !== 'false';
    let isDark = localStorage.getItem('isDark') === 'true';
    let isAdmin = false;
    let adminPassword = '';
    const API_BASE = 'https://taabeer.onrender.com';
    const moods = [
      { id: 'happy', icon: 'fa-laugh-beam', ar: 'سعيدة', en: 'Happy' },
      { id: 'love', icon: 'fa-heart', ar: 'حب', en: 'Love' },
      { id: 'sad', icon: 'fa-sad-tear', ar: 'حزينة', en: 'Sad' },
      { id: 'angry', icon: 'fa-angry', ar: 'غاضبة', en: 'Angry' },
      { id: 'excited', icon: 'fa-grin-stars', ar: 'متحمسة', en: 'Excited' }
    ];
    
    // --- Initialize App ---
    function initApp() {
      // Set initial theme
      if (isDark) {
        document.body.classList.add('dark');
        document.getElementById('mode-icon').className = 'fas fa-sun';
        document.getElementById('mode-text').textContent = isArabic ? 'الوضع المضيء' : 'Light Mode';
      }
      // Set initial language
      updateLanguage();
      // Create floating hearts
      createFloatingHearts();
      // Set up textarea auto-resize
      setupTextarea();
      // Setup mood selector
      setupMoodSelector();
      // Setup password visibility toggle
      setupPasswordToggle();
      // Show couple animation when message is focused
      setupCoupleAnimation();
    }
    
    // Hide admin panel without logging out
    function hideAdminPanel() {
      document.getElementById('admin-panel').classList.remove('active');
    }
    
    // --- Floating Hearts Background ---
    function createFloatingHearts() {
      const container = document.getElementById('floating-hearts');
      const count = Math.floor(window.innerWidth / 20);
      
      for (let i = 0; i < count; i++) {
        const heart = document.createElement('div');
        heart.className = 'floating-heart';
        heart.innerHTML = '<i class="fas fa-heart"></i>';
        
        // Random properties
        const size = 16 + Math.random() * 24;
        const left = Math.random() * 100;
        const delay = Math.random() * 15;
        const duration = 10 + Math.random() * 20;
        
        // Set styles
        heart.style.fontSize = `${size}px`;
        heart.style.left = `${left}%`;
        heart.style.top = `${100 + Math.random() * 20}%`;
        heart.style.animationDelay = `${delay}s`;
        heart.style.animationDuration = `${duration}s`;
        
        container.appendChild(heart);
      }
    }
    
    // --- Couple Animation ---
    function setupCoupleAnimation() {
      const textarea = document.getElementById('message');
      const couple = document.getElementById('couple-animation');
      
      textarea.addEventListener('focus', function() {
        couple.classList.add('active');
      });
      
      textarea.addEventListener('blur', function() {
        if (!this.value.trim()) {
          couple.classList.remove('active');
        }
      });
    }
    
    // --- Mood Selector ---
    function setupMoodSelector() {
      const selector = document.getElementById('mood-selector');
      const options = selector.querySelectorAll('.mood-option');
      
      options.forEach(option => {
        option.addEventListener('click', function() {
          // Remove active class from all options
          options.forEach(opt => opt.classList.remove('active'));
          // Add active class to clicked option
          this.classList.add('active');
          // Create heart pulse effect
          createHeartPulse(this);
        });
      });
    }
    
    // --- Heart Pulse Effect ---
    function createHeartPulse(element) {
      const rect = element.getBoundingClientRect();
      const heart = document.createElement('div');
      heart.className = 'heart-pulse';
      heart.innerHTML = '<i class="fas fa-heart"></i>';
      heart.style.left = `${rect.left + rect.width/2 - 15}px`;
      heart.style.top = `${rect.top + rect.height/2 - 15}px`;
      
      document.body.appendChild(heart);
      
      // Remove after animation
      setTimeout(() => heart.remove(), 2000);
    }
    
    // --- Password Toggle ---
    function setupPasswordToggle() {
      const pwInput = document.getElementById('admin-password');
      const toggleBtn = document.getElementById('toggle-password');
      
      if (pwInput && toggleBtn) {
        toggleBtn.onclick = function(e) {
          e.preventDefault();
          if (pwInput.type === 'password') {
            pwInput.type = 'text';
            toggleBtn.innerHTML = '<i class="fas fa-eye-slash"></i>';
          } else {
            pwInput.type = 'password';
            toggleBtn.innerHTML = '<i class="fas fa-eye"></i>';
          }
        };
      }
    }
    
    // --- Textarea Setup ---
    function setupTextarea() {
      const textarea = document.getElementById('message');
      
      // Auto-resize
      textarea.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
      });
      
      // Create floating hearts when typing
      textarea.addEventListener('input', function() {
        if (this.value.length % 10 === 0 && this.value.length > 0) {
          createRandomHeart();
        }
      });
    }
    
    // --- Create Random Heart ---
    function createRandomHeart() {
      const container = document.getElementById('floating-hearts');
      const heart = document.createElement('div');
      heart.className = 'floating-heart';
      heart.innerHTML = '<i class="fas fa-heart"></i>';
      
      // Random properties
      const size = 16 + Math.random() * 24;
      const left = Math.random() * 100;
      const delay = 0;
      const duration = 5 + Math.random() * 10;
      
      // Set styles
      heart.style.fontSize = `${size}px`;
      heart.style.left = `${left}%`;
      heart.style.top = `100%`;
      heart.style.animationDelay = `${delay}s`;
      heart.style.animationDuration = `${duration}s`;
      heart.style.color = `hsl(${Math.random() * 60 + 330}, 100%, 70%)`;
      
      container.appendChild(heart);
    }
    
    // --- Language Toggle ---
    function toggleLang() {
      isArabic = !isArabic;
      localStorage.setItem('isArabic', isArabic);
      updateLanguage();
    }
    
    function updateLanguage() {
      // Update HTML attributes
      document.documentElement.lang = isArabic ? 'ar' : 'en';
      document.documentElement.dir = isArabic ? 'rtl' : 'ltr';
      
      // Update UI texts
      document.getElementById('title').textContent = isArabic ? 'مذكرات المشاعر للزوجين' : 'Couples Feelings Diary';
      document.getElementById('message').placeholder = isArabic ? 'اكتبي ما تشعرين به هنا...' : 'Write how you feel here...';
      document.getElementById('lang-text').textContent = isArabic ? 'English' : 'العربية';
      document.getElementById('submit-text').textContent = isArabic ? 'إرسال' : 'Send';
      document.getElementById('admin-text').textContent = isArabic ? 'دخول المشرف' : 'Admin Login';
      document.getElementById('login-title').textContent = isArabic ? 'دخول المشرف' : 'Admin Login';
      document.getElementById('admin-password').placeholder = isArabic ? 'كلمة المرور' : 'Password';
      document.getElementById('login-text').textContent = isArabic ? 'دخول' : 'Login';
      document.getElementById('msgs-title').textContent = isArabic ? 'الرسائل المستلمة' : 'Received Messages';
      document.getElementById('logout-text').textContent = isArabic ? 'خروج' : 'Logout';
      document.getElementById('no-msgs-text').textContent = isArabic ? 'لا توجد رسائل بعد' : 'No messages yet';
      document.getElementById('mode-text').textContent = isDark ? 
        (isArabic ? 'الوضع المضيء' : 'Light Mode') : 
        (isArabic ? 'الوضع المظلم' : 'Dark Mode');
      
      // Update mood labels
      moods.forEach(mood => {
        document.getElementById(`${mood.id}-label`).textContent = isArabic ? mood.ar : mood.en;
      });
      
      // Clear errors
      document.getElementById('login-error').textContent = '';
      document.getElementById('msgs-error').textContent = '';
      
      // Rerender messages if admin panel is open
      if (isAdmin && document.getElementById('admin-panel').classList.contains('active')) {
        fetchMessages();
      }
    }
    
    // --- Dark/Light Mode Toggle ---
    function toggleMode() {
      isDark = !isDark;
      localStorage.setItem('isDark', isDark);
      document.body.classList.toggle('dark', isDark);
      
      // Update mode toggle button
      const modeIcon = document.getElementById('mode-icon');
      const modeText = document.getElementById('mode-text');
      if (isDark) {
        modeIcon.className = 'fas fa-sun';
        modeText.textContent = isArabic ? 'الوضع المضيء' : 'Light Mode';
      } else {
        modeIcon.className = 'fas fa-moon';
        modeText.textContent = isArabic ? 'الوضع المظلم' : 'Dark Mode';
      }
      
      // Rerender messages if admin panel is open
      if (isAdmin && document.getElementById('admin-panel').classList.contains('active')) {
        fetchMessages();
      }
    }
    
    // --- Message Submission ---
    async function sendMessage() {
      const message = document.getElementById('message').value.trim();
      if (!message) {
        showTemporaryAlert(isArabic ? 'الرسالة فارغة!' : 'Message is empty!');
        return;
      }
      
      const btn = document.getElementById('submit-btn');
      const originalText = btn.innerHTML;

      // Get selected mood
      const moodOption = document.querySelector('.mood-option.active');
      const selectedMood = moodOption ? moodOption.getAttribute('data-mood') : null;
      if (!selectedMood) {
        showTemporaryAlert(isArabic ? 'يرجى اختيار الحالة المزاجية!' : 'Please select a mood!');
        return;
      }

      // Show loading state
      btn.disabled = true;
      btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i>\n                      <span>${isArabic ? 'جاري الإرسال' : 'Sending'}</span>`;

      try {
        const response = await fetch(`${API_BASE}/api/message`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ content: message, mood: selectedMood })
        });
        const data = await response.json();
        if (response.ok && data.success) {
          createCelebration();
          showTemporaryAlert(isArabic ? 'تم إرسال الرسالة بنجاح ❤' : 'Message sent successfully ❤');
          document.getElementById('message').value = '';
          // Reset textarea height
          const textarea = document.getElementById('message');
          textarea.style.height = 'auto';
          // Hide couple animation
          document.getElementById('couple-animation').classList.remove('active');
        } else {
          // Error
          showTemporaryAlert(data?.error || (isArabic ? 'حدث خطأ أثناء الإرسال' : 'Failed to send message'));
        }
      } catch (error) {
        // Network error
        showTemporaryAlert(isArabic ? 'تعذر الاتصال بالخادم' : 'Failed to connect to server');
      } finally {
        // Reset button
        btn.disabled = false;
        btn.innerHTML = originalText;
      }
    }
    
    // --- Celebration Effect ---
    function createCelebration() {
      const container = document.getElementById('floating-hearts');
      
      for (let i = 0; i < 20; i++) {
        const heart = document.createElement('div');
        heart.className = 'floating-heart';
        heart.innerHTML = '<i class="fas fa-heart"></i>';
        
        // Random properties
        const size = 20 + Math.random() * 30;
        const left = 40 + Math.random() * 20;
        const delay = 0;
        const duration = 2 + Math.random() * 3;
        
        // Set styles
        heart.style.fontSize = `${size}px`;
        heart.style.left = `${left}%`;
        heart.style.top = `70%`;
        heart.style.animationDelay = `${delay}s`;
        heart.style.animationDuration = `${duration}s`;
        heart.style.color = `hsl(${Math.random() * 60 + 330}, 100%, 70%)`;
        
        container.appendChild(heart);
      }
    }
    
    // --- Temporary Alert ---
    function showTemporaryAlert(message) {
      const alert = document.createElement('div');
      alert.textContent = message;
      alert.style.position = 'fixed';
      alert.style.bottom = '20px';
      alert.style.left = '50%';
      alert.style.transform = 'translateX(-50%)';
      alert.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
      alert.style.color = 'white';
      alert.style.padding = '12px 24px';
      alert.style.borderRadius = '50px';
      alert.style.zIndex = '1000';
      alert.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.15)';
      alert.style.animation = 'fadeInUp 0.3s ease-out';
      
      document.body.appendChild(alert);
      
      setTimeout(() => {
        alert.style.animation = 'fadeOut 0.3s ease-out';
        setTimeout(() => alert.remove(), 300);
      }, 3000);
    }
    
    // --- Admin Login Modal ---
    function showLoginModal() {
      // If password is in localStorage, don't open the modal
      if (localStorage.getItem('adminPassword')) {
        showAdminPanel();
        return;
      }
      document.getElementById('login-modal').classList.add('active');
      document.getElementById('admin-password').value = '';
      document.getElementById('login-error').textContent = '';
      setTimeout(() => document.getElementById('admin-password').focus(), 100);
    }
    
    function hideLoginModal() {
      document.getElementById('login-modal').classList.remove('active');
    }
    
    async function adminLogin() {
      const password = document.getElementById('admin-password').value.trim();
      if (!password) {
        hideLoginModal();
        showAdminPanel();
        return;
      }
      
      const btn = document.getElementById('login-btn');
      const originalText = btn.innerHTML;
      
      // Show loading state
      btn.disabled = true;
      btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i>
                      <span>${isArabic ? 'جاري الدخول' : 'Logging in'}</span>`;
      
      try {
        const response = await fetch(`${API_BASE}/api/login`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ password })
        });
        
        const data = await response.json();
        
        if (response.ok && data.success) {
          // Success
          isAdmin = true;
          adminPassword = password;
          localStorage.setItem('adminPassword', password);
          hideLoginModal();
          showAdminPanel();
        } else {
          // Error
          document.getElementById('login-error').textContent = 
            data?.error || (isArabic ? 'كلمة المرور غير صحيحة' : 'Incorrect password');
        }
      } catch (error) {
        // Network error
        document.getElementById('login-error').textContent = 
          isArabic ? 'تعذر الاتصال بالخادم' : 'Failed to connect to server';
      } finally {
        // Reset button
        btn.disabled = false;
        btn.innerHTML = originalText;
      }
    }
    
    // --- Admin Panel ---
    function showAdminPanel() {
      document.getElementById('admin-panel').classList.add('active');
      document.getElementById('msgs-list').innerHTML = '';
      document.getElementById('msgs-error').textContent = '';
      document.getElementById('msgs-empty').style.display = 'none';
      document.getElementById('msgs-loading').style.display = 'flex';
      
      fetchMessages();
    }
    
    function logoutAdmin() {
      isAdmin = false;
      adminPassword = '';
      localStorage.removeItem('adminPassword');
      document.getElementById('admin-panel').classList.remove('active');
    }
    
    async function fetchMessages() {
      try {
        adminPassword = localStorage.getItem('adminPassword');
        if (!adminPassword) {
          hideAdminPanel();
          showLoginModal();
          return;
        }
        const response = await fetch(`${API_BASE}/api/messages`, {
          headers: { password: adminPassword }
        });
        
        const data = await response.json();
        
        if (response.ok && Array.isArray(data)) {
          renderMessages(data);
        } else {
          document.getElementById('msgs-error').textContent = 
            data?.error || (isArabic ? 'تعذر جلب الرسائل' : 'Failed to fetch messages');
          document.getElementById('msgs-empty').style.display = 'none';
        }
      } catch (err) {
        document.getElementById('msgs-error').textContent =
          isArabic ? 'تعذر جلب الرسائل' : 'Failed to fetch messages';
        document.getElementById('msgs-empty').style.display = 'none';
        console.error(err);
        hideAdminPanel();
        localStorage.removeItem('adminPassword');
      }finally{
        document.getElementById('msgs-loading').style.display = 'none';
      }
    }
    
    function renderMessages(messages) {
      const list = document.getElementById('msgs-list');
      list.innerHTML = '';
      messages.forEach(message => {
        const card = document.createElement('div');
        card.className = 'message-card';
        // Get mood icon info
        let mood = moods.find(m => m.id === message.mood);
        let moodIcon = mood ? `<i class="fas ${mood.icon} mood-icon" title="${isArabic ? mood.ar : mood.en}"></i>` : '';
        card.innerHTML = `
          <div class="message-header">
            <span class="msg-status-badge ${message.read ? 'read-badge' : 'unread-badge'}">
              ${message.read ? (isArabic ? '✓ تمت القراءة' : '✓ Read') : (isArabic ? 'غير مقروء' : 'Unread')}
            </span>
            <span>${formatDate(message.createdAt)}</span>
          </div>
          <div class="message-content">
            ${moodIcon}
            <span>${escapeHTML(message.content)}</span>
          </div>
          <div class="message-actions">
            <button class="message-btn mark-read-btn read-btn ${message.read ? 'read-btn' : ''}" ${message.read ? 'disabled' : ''}>
              <i class="fas fa-check-circle"></i> ${message.read ? (isArabic ? 'تم القراءة' : 'Read') : (isArabic ? 'تحديد كمقروء' : 'Mark Read')}
            </button>
            <button class="message-btn delete-msg-btn delete-btn">
              <i class="fas fa-trash-alt"></i> ${isArabic ? 'حذف' : 'Delete'}
            </button>
          </div>
        `;
        
        if (message.read) {
          card.classList.add('read');
        } else {
          card.classList.add('unread');
        }
        
        const markReadBtn = card.querySelector('.mark-read-btn');
        markReadBtn.onclick = () => markAsRead(message._id, markReadBtn);
        
        const deleteBtn = card.querySelector('.delete-msg-btn');
        deleteBtn.onclick = () => deleteMessage(message._id, deleteBtn);
        
        list.appendChild(card);
      });
      
      if (messages.length === 0) {
        document.getElementById('msgs-empty').style.display = 'block';
      }
    }
    
    // --- Helper Functions ---
    function escapeHTML(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML.replace(/\n/g, '<br>');
    }
    
    function formatDate(isoString) {
      if (!isoString) return '';
      const date = new Date(isoString);
      return date.toLocaleString('en-GB', { dateStyle: 'medium', timeStyle: 'short' });
    }
    
    // --- Mark Message as Read ---
    async function markAsRead(messageId, button) {
      try {
        button.disabled = true;
        button.innerHTML = `<i class="fas fa-spinner fa-spin"></i>`;
        
        const response = await fetch(`${API_BASE}/api/messages/${messageId}/read`, {
          method: 'PATCH',
          headers: { 
            'Content-Type': 'application/json',
            password: adminPassword
          }
        });
        const data = await response.json();
        
        if (response.ok && data.success) {
          // Update UI
          const card = button.closest('.message-card');
          card.classList.remove('unread');
          card.classList.add('read');
          button.innerHTML = `<i class="fas fa-check-circle"></i> ${isArabic ? 'تمت القراءة' : 'Read'}`;
          button.style.opacity = '0.7';
          button.disabled = true;
        } else {
          showTemporaryAlert(data?.error || (isArabic ? 'فشل تحديث الحالة' : 'Failed to update status'));
          button.disabled = false;
          button.innerHTML = `<i class="fas fa-check-circle"></i> ${isArabic ? 'تم القراءة' : 'Mark Read'}`;
        }
      } catch (error) {
        showTemporaryAlert(isArabic ? 'خطأ في الاتصال' : 'Connection error');
        button.disabled = false;
        button.innerHTML = `<i class="fas fa-check-circle"></i> ${isArabic ? 'تم القراءة' : 'Mark Read'}`;
      }
    }
    
    // --- Delete Message ---
    async function deleteMessage(messageId, button) {
      if (!confirm(isArabic ? 'هل أنت متأكد من حذف هذه الرسالة؟' : 'Are you sure you want to delete this message?')) {
        return;
      }
      try {
        button.disabled = true;
        button.innerHTML = `<i class="fas fa-spinner fa-spin"></i>`;
        
        const response = await fetch(`${API_BASE}/api/messages/${messageId}`, {
          method: 'DELETE',
          headers: { 
            'Content-Type': 'application/json',
            password: adminPassword
          }
        });
        const data = await response.json();
        
        if (response.ok && data.success) {
          // Remove from UI
          const card = button.closest('.message-card');
          card.style.animation = 'fadeOut 0.3s ease-out';
          setTimeout(() => card.remove(), 300);
          showTemporaryAlert(isArabic ? 'تم الحذف بنجاح' : 'Message deleted');
        } else {
          showTemporaryAlert(data?.error || (isArabic ? 'فشل الحذف' : 'Delete failed'));
          button.disabled = false;
          button.innerHTML = `<i class="fas fa-trash-alt"></i> ${isArabic ? 'حذف' : 'Delete'}`;
        }
      } catch (error) {
        showTemporaryAlert(isArabic ? 'خطأ في الاتصال' : 'Connection error');
        button.disabled = false;
        button.innerHTML = `<i class="fas fa-trash-alt"></i> ${isArabic ? 'حذف' : 'Delete'}`;
      }
    }
    
    // --- Initialize on Load ---
    document.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>